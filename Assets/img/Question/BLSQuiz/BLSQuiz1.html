<!DOCTYPE html>
<html oncontextmenu="return false" onselectstart="return false" ondragstart="return false">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BLS Quiz 1</title>
    <link rel="icon" type="image/png" href="https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Icon/favicon.png">	
    <style>
        body {
            background-color: #f5f5f5;
            color: #000000;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
        }
        .quiz-container {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            background-color: #ffffff;
            padding: 20px;
            padding-top: 60px; /* Space for timer */
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            box-sizing: border-box;
        }
        .timer-container {
            position: absolute;
            top: 20px;
            right: 20px;
        }
        @media (min-width: 601px) {
            .quiz-container {
                width: 75vw;
                max-width: 1200px;
                transform: scale(1.1);
                transform-origin: top center;
            }
            .question, .follow-up {
                font-size: 1.9em;
            }
            .choice {
                font-size: 1.3em;
            }
            .timer-btn {
                font-size: 1.5em;
            }
            .indicators {
                font-size: 1.2em;
            }
            button, a.button-link {
                font-size: 1.3em;
            }
        }
        @media (max-width: 600px) {
            .timer-btn {
                padding: 8px 15px;
                font-size: 1em;
            }
            .question {
                font-size: 1.1em; /* Smaller than 1.2em, larger than choices (1em) */
            }
            .follow-up {
                font-size: 1em;
            }
            .choice {
                font-size: 1em;
            }
            button {
                padding: 8px 15px;
                font-size: 1em;
            }
            .indicators {
                font-size: 0.9em;
            }
            .result-page h1 {
                font-size: 1.5em;
            }
            .result-page p {
                font-size: 1em;
            }
        }
        .timer-btn {
            padding: 10px 20px;
            background-color: #e0e0e0;
            color: #000000;
            border: 1px solid #cccccc;
            border-radius: 5px;
            cursor: default;
            font-size: 1.2em;
        }
        .question-image {
            max-width: 100%;
            height: auto;
            display: block;
            margin: 10px auto;
            border: 1px solid #ffffff;
            border-radius: 5px;
        }
        .question {
            font-size: 1.5em;
            margin: 20px 0 10px 0;
        }
        .follow-up {
            font-size: 1.5em;
            margin: 10px 0;
            color: #000000;
        }
        .choices {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .choice {
            padding: 10px;
            background-color: #f0f0f0;
            border: 1px solid #cccccc;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .choice:hover {
            background-color: #e0e0e0;
        }
        .choice.selected {
            background-color: #9BC4E2;
            border-color: #cccccc;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            position: relative;
        }
        .nav-buttons-left {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .nav-buttons-right {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: flex-end;
        }
        .center-buttons {
            display: flex;
            gap: 10px;
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }
        button {
            padding: 8px 15px;
            background-color: #e0e0e0;
            color: #000000;
            border: 1px solid #cccccc;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #AC3834;
            color: #ffffff;
        }
        .indicators {
            font-size: 0.95em;
            color: #333333;
            font-weight: bold;
        }
        .result-page {
            text-align: center;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            overflow: visible;
        }
        .result-pass {
            background-color: #d4edda;
        }
        .result-fail {
            background-color: #f8d7da;
        }
        .result-page h1 {
            font-size: 2em;
            margin: 20px 0;
            color: #000000;
            position: relative;
            z-index: 1;
        }
        .result-page p {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #555555;
            position: relative;
            z-index: 1;
        }
        .result-page button {
            position: relative;
            z-index: 1;
        }
        .pyro {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        .pyro > .before, .pyro > .after {
            position: absolute;
            width: 5px;
            height: 5px;
            border-radius: 50%;
            box-shadow: 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff,
                        0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff,
                        0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff,
                        0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff,
                        0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff, 0 0 #fff;
            animation: 1s bang ease-out infinite backwards, 1s gravity ease-in infinite backwards, 5s position linear infinite backwards;
        }
        .pyro > .after {
            animation-delay: 1.25s, 1.25s, 1.25s;
            animation-duration: 1.25s, 1.25s, 6.25s;
        }
        @keyframes bang {
            to {
                box-shadow: 
                    -225px 150px hsl(120, 100%, 50%), 175px 325px hsl(240, 100%, 50%), -75px 200px hsl(60, 100%, 50%),
                    125px 275px hsl(300, 100%, 50%), -200px 250px hsl(180, 100%, 50%), 50px 100px hsl(0, 100%, 50%),
                    225px 300px hsl(90, 100%, 50%), -150px 175px hsl(270, 100%, 50%), 100px 225px hsl(30, 100%, 50%),
                    -50px 125px hsl(330, 100%, 50%), -175px 275px hsl(150, 100%, 50%), 200px 200px hsl(210, 100%, 50%),
                    75px 150px hsl(45, 100%, 50%), -125px 300px hsl(315, 100%, 50%), 150px 250px hsl(75, 100%, 50%),
                    -100px 100px hsl(255, 100%, 50%), 25px 325px hsl(15, 100%, 50%), -200px 200px hsl(345, 100%, 50%),
                    175px 175px hsl(105, 100%, 50%), -75px 250px hsl(225, 100%, 50%), 50px 275px hsl(165, 100%, 50%),
                    225px 125px hsl(285, 100%, 50%), -150px 300px hsl(135, 100%, 50%), 100px 150px hsl(195, 100%, 50%),
                    -50px 225px hsl(60, 100%, 50%), -175px 100px hsl(300, 100%, 50%), 200px 325px hsl(120, 100%, 50%),
                    75px 200px hsl(240, 100%, 50%), -125px 175px hsl(0, 100%, 50%), 150px 250px hsl(180, 100%, 50%),
                    -100px 275px hsl(90, 100%, 50%), 25px 125px hsl(270, 100%, 50%), -200px 300px hsl(30, 100%, 50%),
                    175px 150px hsl(330, 100%, 50%), -75px 225px hsl(150, 100%, 50%), 50px 100px hsl(210, 100%, 50%),
                    225px 275px hsl(45, 100%, 50%), -150px 200px hsl(315, 100%, 50%), 100px 325px hsl(75, 100%, 50%),
                    -50px 175px hsl(255, 100%, 50%), -175px 250px hsl(15, 100%, 50%), 200px 125px hsl(345, 100%, 50%),
                    75px 300px hsl(105, 100%, 50%), -125px 150px hsl(225, 100%, 50%), 150px 275px hsl(165, 100%, 50%),
                    -100px 200px hsl(285, 100%, 50%), 25px 250px hsl(135, 100%, 50%), -200px 175px hsl(195, 100%, 50%),
                    175px 225px hsl(60, 100%, 50%), -75px 100px hsl(300, 100%, 50%);
            }
        }
        @keyframes gravity {
            to {
                transform: translateY(200px);
                opacity: 0;
            }
        }
        @keyframes position {
            0%, 19.9% {
                margin-top: 10%;
                margin-left: 40%;
            }
            20%, 39.9% {
                margin-top: 40%;
                margin-left: 30%;
            }
            40%, 59.9% {  
                margin-top: 20%;
                margin-left: 70%;
            }
            60%, 79.9% {  
                margin-top: 30%;
                margin-left: 20%;
            }
            80%, 99.9% {  
                margin-top: 30%;
                margin-left: 80%;
            }
        }
        hr {
            border: 1px solid #dddddd;
        }
        a.button-link {
            display: inline-block;
            padding: 8px 15px;
            background-color: #e0e0e0;
            color: #000000;
            text-decoration: none;
            border: 1px solid #cccccc;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        a.button-link:hover {
            background-color: #AC3834;
            color: #ffffff;
        }
    </style>
</head>
<body>
    <div class="quiz-container">
        <div class="timer-container">
            <button class="timer-btn" id="timer">30:00</button>
        </div>
        <div id="quiz-content"></div>
        <div class="navigation">
            <div class="nav-buttons-left">
                <div class="center-buttons" id="centerButtons">
                    <button id="prevBtn">Previous</button>
                    <button id="nextBtn">Next</button>
                </div><h1> </h1>
                <a href="https://raw.githack.com/CanisioG/ACLSReview/refs/heads/main/Assets/img/Menu/BLSTest.html" class="button-link" id="backBtn">Back</a>
                <button id="resetBtn">Reset</button>
            </div>
            <div class="nav-buttons-right">
                <h1> </h1><br><span class="indicators" id="questionNumber">Question: 1/25</span>
            </div>
        </div>
    </div>

    <script>
        let questions = [
    {
        question: "While performing high-quality CPR on an adult, what action should you ensure is being accomplished?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Maintaining a compression rate of 90 to 120/min", "Placing hands on the upper third of the sternum", "Allowing the chest to recoil 1 inch", "Compressing to a depth of at least 2 inches"],
        correct: 3
    },
    {
        question: "A 53-year-old woman collapses while gardening. She is unresponsive, is not breathing, and does not have a pulse. A neighbor, who is an emergency medical technician, rushes to her with an AED.<br><br>When the AED arrives, what is the first step for using it?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Apply the pads to the patient's chest", "Clear the patient", "Turn on the AED", "Press the shock button"],
        correct: 2
    },
    {
        question: "A 53-year-old woman collapses while gardening. She is unresponsive, is not breathing, and does not have a pulse. A neighbor, who is an emergency medical technician, rushes to her with an AED.<br><br>After the AED pads are attached to the victim's bare chest, the AED detects ventricular fibrillation. What is the next step when using an AED?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Check the victim for a carotid pulse", "Follow the AED prompts", "Clear the patient", "Press the shock button"],
        correct: 1
    },
    {
        question: "What should you do if you need to use an AED on someone who has been submerged in water?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Do not move the victim, and do not use the AED", "Pull the victim out of the water, but do not use the AED", "Pull the victim out of the water, and wipe the chest", "Do not pull the victim out of the water, but wipe the chest before placing pads"],
        correct: 2
    },
    {
        question: "How can rescuers ensure that they are providing effective breaths when using a bag-mask device?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Observing the chest rise with breaths", "Delivering breaths quickly and forcefully", "Always having oxygen attached to the bag", "Allowing air to release around the mask"],
        correct: 0
    },
    {
        question: "What ratio for compressions to breaths should be used for 1-rescuer infant CPR?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["5 compressions to 1 breath", "20 compressions to 2 breaths", "15 compressions to 2 breaths", "30 compressions to 2 breaths"],
        correct: 3
    },
    {
        question: "What is a consideration when you are using an AED?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["You should never remove a transdermal medication patch before applying AED pads", "On a hairy chest, the pads may not stick and may fail to deliver a shock", "AEDs can be used while a victim is submerged in water", "You should not use an AED on someone with an implanted pacemaker"],
        correct: 1
    },
    {
        question: "A 9-year-old child has suddenly collapsed. After confirming that the scene is safe, a single rescuer determines that the child is in cardiac arrest, shouts for nearby help, and activates the emergency response system. He immediately begins performing high-quality CPR. Two additional rescuers arrive to assist in the resuscitation attempt.<br><br>What actions should occur next, to support a team-based resuscitation attempt?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["2 rescuers alternate using the AED and giving breaths", "1 rescuer gives CPR while the other 2 wait for advanced life support to arrive", "2 rescuers alternate giving high-quality chest compressions", "2 rescuers operate the AED while the third rescuer gives breaths"],
        correct: 2
    },
    {
        question: "A 9-year-old child has suddenly collapsed. After confirming that the scene is safe, a single rescuer determines that the child is in cardiac arrest, shouts for nearby help, and activates the emergency response system. He immediately begins performing high-quality CPR. Two additional rescuers arrive to assist in the resuscitation attempt.<br><br>Two rescuers begin high-quality CPR while the third rescuer leaves to get the AED. What action supports 2-rescuer CPR?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Alternating the AED role every 2 minutes", "Alternating the compressor role every 2 minutes", "Alternating giving rescue breaths every 3 cycles", "Alternating giving shocks every 3 cycles"],
        correct: 1
    },
    {
        question: "''Members of the team know their boundaries and ask for help before the resuscitation attempt worsens.'' Match this statement with the most appropriate element of team dynamics listed.",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Knowledge sharing", "Summarizing and reevaluation", "Constructive intervention", "Knowing your limitations"],
        correct: 3
    },
    {
        question: "A victim with a foreign-body airway obstruction becomes unresponsive. What is your first course of action?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Start CPR, beginning with chest compressions", "Roll the victim over and perform back blows", "Perform abdominal thrusts", "Perform blind finger sweeps"],
        correct: 0
    },
    {
        question: "Why is defibrillation important?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["It prevents rearrest from occurring", "It is not important for cardiac arrest", "There is a 100% success rate in regaining a normal cardiac rhythm", "It can restore a regular cardiac rhythm"],
        correct: 3
    },
    {
        question: "You witness someone suddenly collapse. The person is unresponsive, you hear gasping sounds, and there is no pulse. What should you do next?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Begin CPR; the gasps are not normal breathing", "Give rescue breaths only; the gasps are not normal breathing", "Monitor the patient; the gasps are considered normal breathing", "Begin CPR, even though gasping is normal breathing"],
        correct: 0
    },
    {
        question: "A middle-aged man collapses. You and a second rescuer go to the victim and find that he is unresponsive, is not breathing, and does not have a pulse.<br><br>Which action is most likely to positively impact this victim's survival?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Performing high-quality CPR", "Ensuring scene safety", "Providing rescue breaths", "Checking the pulse frequently"],
        correct: 0
    },
    {
        question: "A middle-aged man collapses. You and a second rescuer go to the victim and find that he is unresponsive, is not breathing, and does not have a pulse.<br><br>You and another rescuer begin CPR. After a few cycles, you notice the chest compression rate is slowing. What should you say to offer constructive feedback?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["''You need to compress at a rate of 80 to 120 per minute.''", "''You need to compress at a rate of at least 120 per minute.''", "''You need to compress at a rate of 100 to 120 per minute.''", "''You need to compress at a rate of at least 100 per minute.''"],
        correct: 2
    },
    {
        question: "How do you perform chest compressions when providing high-quality CPR to a child victim?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["By compressing the chest at least one third the depth of the chest, about 2 inches (5 cm)", "By compressing the chest at least one fourth the depth of the chest, about 1.5 inches (4 cm)", "By compressing the chest at least two thirds the depth of the chest, about 4 inches (10 cm)", "By compressing the chest at least one half the depth of the chest, about 3 inches (8 cm)"],
        correct: 0
    },
    {
        question: "When performing CPR on an unresponsive choking victim, what modification should you incorporate?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["There are no modifications to CPR for an unresponsive choking victim", "You do not give breaths to an unresponsive choking victim", "Each time you open the airway, look for the obstructing object", "Attempt a jaw thrust instead of a head tilt-chin lift"],
        correct: 2
    },
    {
        question: "An 8-month-old infant is eating and suddenly begins to cough. The infant is unable to make any noise shortly after. You pick up the infant and shout for help.<br><br>You have determined that the infant is responsive and choking with a severe airway obstruction. How do you relieve the airway obstruction?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Encourage the infant to cough", "Give sets of 5 back slaps and 5 chest thrusts", "Begin 2 thumb-encircling hands chest compressions", "Give abdominal thrusts"],
        correct: 1
    },
    {
        question: "An 8-month-old infant is eating and suddenly begins to cough. The infant is unable to make any noise shortly after. You pick up the infant and shout for help.<br><br>Which action do you perform to relieve choking in an unresponsive infant?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Perform CPR, and look in the mouth for the obstructing object", "Give sets of 5 back slaps and 5 chest thrusts", "Give sets of 5 abdominal thrusts and 5 back slaps", "Attempt a blind finger sweep when giving breaths to remove the obstructing object"],
        correct: 0
    },
    {
        question: "Which victim requires high-quality CPR?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["A victim who is unresponsive, has a strong pulse, and is breathing adequately", "A victim who is unresponsive with no normal breathing and no pulse", "A victim who is responsive, has a pulse, and is having trouble breathing", "A victim who is responsive, is having trouble breathing, and has a pulse less than 60/min"],
        correct: 1
    },
    {
        question: "''The team functions smoothly when all team members know their positions, functions, and tasks during a resuscitation attempt.'' Match this statement with the most appropriate element of team dynamics listed.",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Clear roles and responsibilities", "Knowing your limitations", "Constructive intervention", "Mutual respect"],
        correct: 0
    },
    {
        question: "Why is allowing complete chest recoil important when performing high-quality CPR?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["There will be a reduction of rescuer fatigue", "It will reduce the risk of rib fractures", "The heart will adequately refill between compressions", "The rate of chest compressions will increase"],
        correct: 2
    },
    {
        question: "A 67-year-old man is found unresponsive, not breathing, and without a pulse. You and a second rescuer begin performing high-quality CPR.<br><br>When should rescuers switch positions during CPR?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Never switch rescuers, and maintain current roles", "Switch rescuers at 5-minute intervals", "Switch rescuers about every 2 minutes", "Switch rescuers when placing the AED pads"],
        correct: 2
    },
    {
        question: "A 67-year-old man is found unresponsive, not breathing, and without a pulse. You and a second rescuer begin performing high-quality CPR.<br><br>You notice the person giving chest compressions is not allowing for complete chest recoil. What is your next course of action?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["Stand back and await direction from the team leader", "Take over leadership and give direction", "Immediately take over chest compressions", "Tell the compressor you notice decreased chest recoil"],
        correct: 3
    },
    {
        question: "Rapid defibrillation is a link in the adult Chain of Survival. Why is this important to survival?",
        image: "https://raw.githubusercontent.com/canisiog/ACLSReview/refs/heads/main/Assets/img/Rythm/Fill.png",
        followUp: " ",
        choices: ["It prevents cardiac arrest", "It prevents respiratory arrest", "It provides normal respiration", "It eliminates the abnormal heart rhythm"],
        correct: 3
    }
    ];

        let currentQuestion = 0;
        let answers = new Array(25).fill(null);
        let timeLeft = 30 * 30;
        let timerId;

        // Fisher-Yates shuffle function
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // Function to shuffle questions and their choices
        function shuffleQuestionsAndChoices(questionsArray) {
            // Shuffle questions
            let shuffledQuestions = shuffle([...questionsArray]);
            // Shuffle choices for each question
            return shuffledQuestions.map(question => {
                const choices = [...question.choices];
                const correctAnswer = choices[question.correct]; // Store correct answer text
                const shuffledChoices = shuffle([...choices]);
                // Find new index of correct answer
                const newCorrectIndex = shuffledChoices.indexOf(correctAnswer);
                return {
                    ...question,
                    choices: shuffledChoices,
                    correct: newCorrectIndex
                };
            });
        }

        function startTimer() {
            timerId = setInterval(() => {
                timeLeft--;
                const minutes = Math.floor(timeLeft / 30);
                const seconds = timeLeft % 30;
                document.getElementById('timer').textContent = 
                    `${minutes}:${seconds < 10 ? '0' + seconds : seconds}`;
                if (timeLeft <= 0) {
                    clearInterval(timerId);
                    showResults();
                }
            }, 1000);
        }

        function updateIndicators() {
            document.getElementById('questionNumber').textContent = `Question: ${currentQuestion + 1}/25`;
        }

        function calculateScore() {
            let correct = 0;
            for (let i = 0; i < questions.length; i++) {
                if (answers[i] === questions[i].correct) {
                    correct++;
                }
            }
            return correct;
        }

        function renderQuestion() {
            const q = questions[currentQuestion];
            const content = `
                <div class="question">${q.question}</div>
                <img src="${q.image}" class="question-image" alt="Question ${currentQuestion + 1}">
                <div class="follow-up">${q.followUp}</div>
                <div class="choices">
                    ${q.choices.map((choice, i) => `
                        <div class="choice ${answers[currentQuestion] === i ? 'selected' : ''}" 
                             onclick="selectAnswer(${i})">${choice}</div>
                    `).join('')}
                </div>
            `;
            document.getElementById('quiz-content').innerHTML = content;
            document.getElementById('prevBtn').disabled = currentQuestion === 0;
            document.getElementById('nextBtn').textContent = currentQuestion === 24 ? 'Submit' : 'Next';
            document.getElementById('centerButtons').style.display = 'flex';
            document.querySelector('.navigation').style.display = 'flex';
            updateIndicators();
        }

        function showResults() {
            clearInterval(timerId);
            const score = calculateScore();
            const percentage = (score / 25) * 100;
            const passed = percentage >= 80;
            const resultClass = passed ? 'result-pass' : 'result-fail';
            const message = passed ? 'You Passed!' : 'You Failed!';
            const fireworks = passed ? '<div class="pyro"><div class="before"></div><div class="after"></div></div>' : '';
            const content = `
                <div class="result-page ${resultClass}">
                    ${fireworks}
                    <h1>${message}</h1>
                    <p>You scored ${score}/25 (${percentage.toFixed(0)}%).</p>
                    <button id="retakeBtn">Retake</button>
                </div>
            `;
            document.getElementById('quiz-content').innerHTML = content;
            document.getElementById('centerButtons').style.display = 'none';
            document.querySelector('.navigation').style.display = 'none';
            document.getElementById('timer').textContent = 'Timeâ€™s Up!';
            document.getElementById('retakeBtn').addEventListener('click', resetQuiz);
        }

        function selectAnswer(index) {
            answers[currentQuestion] = index;
            renderQuestion();
        }

        function resetQuiz() {
            currentQuestion = 0;
            answers = new Array(25).fill(null);
            timeLeft = 30 * 30;
            clearInterval(timerId);
            document.getElementById('timer').textContent = '30:00';
            questions = shuffleQuestionsAndChoices(questions); // Shuffle questions and choices on reset
            startTimer();
            renderQuestion();
        }

        // Shuffle questions and choices on page load
        questions = shuffleQuestionsAndChoices(questions);

        startTimer();
        renderQuestion();
        
        document.getElementById('nextBtn').addEventListener('click', () => {
            if (answers[currentQuestion] === null) {
                alert('Please select your answer');
            } else if (currentQuestion < 24) {
                currentQuestion++;
                renderQuestion();
            } else {
                showResults();
            }
        });

        document.getElementById('prevBtn').addEventListener('click', () => {
            if (currentQuestion > 0) {
                currentQuestion--;
                renderQuestion();
            }
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            resetQuiz();
        });

        document.onkeydown = function(e) {
            if (e.keyCode == 123 || 
                (e.ctrlKey && e.shiftKey && e.keyCode == 73) || 
                (e.ctrlKey && e.shiftKey && e.keyCode == 74) || 
                (e.ctrlKey && e.keyCode == 85)) {
                return false;
            }
        }			
    </script>
</body>
</html>